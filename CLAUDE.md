# Claude Code Rules

Универсальные правила. Проектная специфика: `.claude/rules/project.md`

## Поведение ИИ

- Дотошный: конкретные вопросы, не общие
- Внимателен к edge cases
- Все вопросы — в narrative спеку, не в чат

## Главное правило

**Спека → Код.** Вся разработка строго по [SDD.md](SDD.md).

## Code Style

- Лаконичность > многословность
- Один способ реализации, без фолбэков
- Удалять артефакты, не хранить "на всякий случай"
- Никаких временных решений и заглушек
- Комментарии только где логика неочевидна
- Понятные названия вместо документации
- Строгая типизация Python 3.12+

### Именование модулей

```
src/modules/<name>_module/
├── __init__.py
├── <name>.py          # основной файл, класс <Name>
└── ...
```

| Элемент | Правило | Пример |
|---|---|---|
| Папка | `<name>_module/` | `database_module/` |
| Файл | `<name>.py` | `database.py` |
| Класс | `<Name>` (PascalCase) | `Database` |

## Critical Rules

- НЕ ПУШИТЬ без явного запроса
- НЕ создавать документацию по инициативе
- НЕ редактировать CLAUDE.md — он синхронизируется из canonical
- Завершенные TODO удалять после коммита

## Протокол закрытия чата

Выполнять по запросу пользователя ("закрой чат", "протокол закрытия").

### 1. Проверка состояния

```bash
git status
```

Определить:

- Какие файлы изменены в этой сессии
- Какие изменения были ДО сессии (не трогать)

### 2. Коммит изменений сессии

**⚠️ КРИТИЧНО:** Незакоммиченные изменения теряются!

```bash
git add <только файлы этой сессии>
git commit -m "<описание>"
```

**Не коммитить** изменения, которые были до начала сессии.

### 3. Сохранение знаний

Если появились новые паттерны/проверки/команды — добавить в скиллы:

| Тип знания | Куда сохранять |
| --- | --- |
| Новый паттерн/команда | `.claude/skills/<domain>/SKILL.md` |
| Проект-специфичные правила | `.claude/rules/project.md` |
| Задачи | `specs/TODO.md` |

Перед сохранением: проверить на дублирование.

### 4. Резюме и чеклист

**Резюме сессии:**

- Список коммитов сессии
- Что было сделано

**Чеклист:**

- [ ] Свои изменения закоммичены
- [ ] Скиллы обновлены (если новые паттерны)
- [ ] **git status** — свои изменения чисты
- [ ] Нет незавершённых действий

⚠️ Незакоммиченные изменения других сессий — сообщить пользователю, не трогать

## Стиль

- Кратко и по делу, технический язык
- Приоритеты: корректность → простота → поддерживаемость
